{% extends "base.html" %}
{% block content %}
<h2>Reset Password</h2>
{% if not user %}
<form method="post" action="{{ url_for('reset_password') }}">
  <div class="mb-3">
    <label>Username</label>
    <input name="username" class="form-control" required>
  </div>
  <button type="submit" class="btn btn-primary">Next</button>
</form>
{% elif not verified %}
<form method="post" action="{{ url_for('reset_password') }}">
  <input type="hidden" name="username" value="{{ username }}">
  <div class="mb-3">
    <label>{{ security_question }}</label>
    <input name="security_answer" class="form-control" required>
  </div>
  <button type="submit" class="btn btn-primary">Verify</button>
</form>
{% else %}
<form method="post" action="{{ url_for('reset_password') }}">
  <input type="hidden" name="username" value="{{ username }}">
  <input type="hidden" name="security_answer" value="verified">
  <input type="hidden" name="verified" value="1">
  <div class="mb-3">
    <label>New Password</label>
    <input name="password" type="password" class="form-control" required>
  </div>
  <div class="mb-3">
    <label>Confirm New Password</label>
    <input name="confirm_password" type="password" class="form-control" required>
  </div>
  <button type="submit" class="btn btn-primary">Reset Password</button>
</form>
{% endif %}
<div class="mt-3">
  <a href="{{ url_for('login') }}">Back to Login</a>
</div>
{% endblock %}